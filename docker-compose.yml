# ============================================================================
# NesVentory Docker Compose Configuration
# ============================================================================
# This docker-compose.yml provides an example configuration for running
# NesVentory as a self-hosted home inventory management application.
#
# Version: 6.0 (SQLite-based unified container)
# Documentation: https://github.com/tokendad/NesVentory
# ============================================================================
services:
  nesventory-local:
    build: .
    container_name: nesventory5
    restart: unless-stopped
    ports:
      - "5151:5151"
    environment:
      # IMPORTANT: Generate secure, random keys for these values before deploying!
      SECRET_KEY: CHANGE_ME_GENERATE_SECURE_KEY_HERE
      JWT_SECRET_KEY: CHANGE_ME_GENERATE_SECURE_KEY_HERE
      PUID: 1000
      PGID: 1000
      UMASK: 002
      TZ: Etc/UTC
      APP_PORT: 5151
      ACCESS_TOKEN_EXPIRE_MINUTES: 30
      JWT_ALGORITHM: HS256
      # GEMINI_API_KEY: your-gemini-api-key-here
      # GEMINI_MODEL: gemini-2.0-flash
      # GEMINI_REQUEST_DELAY: 4.0
      # GOOGLE_CLIENT_ID: your-google-client-id
      # GOOGLE_CLIENT_SECRET: your-google-client-secret
      DISABLE_SIGNUPS: true
    volumes:
      - /data/DockerConfigs/nesventory5-data:/app/data
      - /etc/localtime:/etc/localtime:ro

    healthcheck:
      # Use CMD-SHELL so the container's APP_PORT environment variable is used.
      # This assumes the container has curl available; if not, switch to python3 or
      # install curl in the image.
      test: ["CMD-SHELL", "curl -fsS http://localhost:5151/api/health || exit 1"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
